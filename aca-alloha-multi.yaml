---
location: eastus
environmentId: "/subscriptions/adfaeed5-81e6-47e5-ac7d-b818fbc412ab/resourceGroups/rg-alloha-prod/providers/Microsoft.App/managedEnvironments/env-alloha-prod"
configuration:
	ingress:
		external: true
		targetPort: 8000
	secrets: [] # Os secrets já estão configurados no ambiente, não é necessário declarar aqui
containers:
	- name: alloha-backend
		image: allohaapp.azurecr.io/alloha-backend:latest
		resources:
			cpu: 1.0
			memory: 2Gi
		env:
			- name: WHATSAPP_ACCESS_TOKEN
				secretRef: WHATSAPP_ACCESS_TOKEN
			- name: WHATSAPP_WEBHOOK_VERIFY_TOKEN
				secretRef: WHATSAPP_WEBHOOK_VERIFY_TOKEN
			- name: WHATSAPP_PHONE_NUMBER_ID
				secretRef: WHATSAPP_PHONE_NUMBER_ID
			- name: SECRET_KEY
				secretRef: SECRET_KEY
			- name: AI_PROVIDER
				value: ollama
	- name: ollama
		image: ollama/ollama:latest
		resources:
			cpu: 2.0
			memory: 4Gi
		env:
			- name: OLLAMA_MODELS
				value: "llama3:latest, llama3.2-vision:latest"
			- name: OLLAMA_API_KEY
				secretRef: OLLAMA_API_KEY
		ports:
			- 11434
---
